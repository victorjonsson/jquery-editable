/*
 * jQuery plugin that makes any element on your page editable
 *
 * @author Victor Jonsson (http://victorjonsson.se/)
 * @website https://github.com/victorjonsson/jquery-editable/
 * @license Dual licensed under the MIT or GPL Version 2 licenses
 * @version 1.0
 * @donations http://victorjonsson.se/donations/
 */
(function($){var $w=$(window),$ta=false,fst=function(e){if(e.metaKey&&(e.keyCode==38||e.keyCode==40)){var fontSize=parseInt($ta.css("font-size"),10);fontSize+=e.keyCode==40?-1:1;$ta.css("font-size",fontSize+"px")}if($ta[0].scrollHeight!==parseInt($ta.attr("data-scroll"),10)){var $tmpArea=$ta.clone(false);$tmpArea.val($ta.val()).css({position:"absolute",visibility:"hidden",top:0,left:0}).appendTo("body");$ta.css("height",$tmpArea[0].scrollHeight+"px");$ta.attr("data-scroll",$ta[0].scrollHeight);$tmpArea.remove()}},eed=function($el,callback){if($el.attr("data-is-editing")!==undefined)return;$el.attr("data-is-editing","1");var dt=$.trim($el.html()).replace(/<br( |)(|\/)>/g,"\n"),dfs=$el.css("font-size"),eh=$el.outerHeight(),ts="width: 96%; padding: 2%; margin:8px 0";$ta=$("<textarea></textarea>");$el.text("");if($.browser.webkit){ts=document.defaultView.getComputedStyle($el.get(0),"").cssText}$w.bind("keydown",fst);$ta.val(dt).blur(function(){var nt=$.trim($ta.val()).replace(new RegExp("\n","g"),"<br />"),nfs=$ta.css("font-size");$el.html(nt);$el.removeAttr("data-is-editing");$ta.remove();$w.unbind("keydown",fst);if(typeof callback=="function"){callback({text:nt==dt?false:nt,fontSize:nfs==dfs?false:nfs,$el:$el})}}).attr("style",ts).appendTo($el).css("height",eh+"px").focus().get(0).select();$el.trigger("edit",[$ta])},eet=function(event){eed($(this),event.data.callback);return false};$.fn.editable=function(callback,evt){if(!evt)evt="dblclick";evt+=".textEditor";if(callback==="destroy"){return this.unbind(evt)}else{return this.bind(evt,{callback:callback},eet)}}})(jQuery);
